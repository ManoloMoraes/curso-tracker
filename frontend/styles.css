:root{
  --bg: #ffffff;
  --surface: #fafafa;
  --text: #0f172a;
  --muted: #64748b;
  --border: #e5e7eb;
  --accent: #3b82f6;
  --accent-ink: #ffffff;
  --green: #10b981;
  --tile-bg: #e5e7eb;
  --tile-ink: #111827;
}

:root[data-theme="dark"]{
  --bg: #0b1220;
  --surface: #0f172a;
  --text: #e5e7eb;
  --muted: #94a3b8;
  --border: #1f2937;
  --accent: #60a5fa;
  --accent-ink: #030712;
  --green: #34d399;
  --tile-bg: #111827;
  --tile-ink: #e5e7eb;
}

*{ box-sizing:border-box }
html, body, #app{ height:100% }
body{
  margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
  background:var(--bg); color:var(--text);
}

#app{ display:flex }

/* Sidebar */
#sidebar{
  width: 310px; min-width: 260px; max-width: 340px;
  border-right: 1px solid var(--border);
  background: var(--surface);
  display:flex; flex-direction:column;
  height: 100vh; position: sticky; top: 0;
}
.sidebar-header{
  display:flex; align-items:center; gap:.6rem;
  padding: 1rem 1rem; border-bottom:1px solid var(--border);
  font-weight: 700;
}
.logo{ font-size: 1.3rem }
.brand{ letter-spacing:.2px }

.add-block{ padding: .75rem 1rem; border-bottom:1px solid var(--border); }
.btn{
  appearance:none; border:1px solid var(--border); background:transparent; color:var(--text);
  padding:.5rem .7rem; border-radius:.5rem; cursor:pointer; font-weight:600;
}
.btn:hover{ border-color: var(--muted) }
.btn.primary{ background: var(--accent); color: var(--accent-ink); border-color: var(--accent) }
.btn.ghost{ background: transparent }

.tree{
  padding:.5rem 0; overflow:auto; flex:1;
}
.tree .course{
  border-bottom:1px dashed var(--border);
  padding:.5rem .5rem  .3rem .5rem;
}
.tree .course .title-row{
  display:flex; align-items:center; justify-content:space-between; gap:.5rem;
  cursor:pointer; padding:.35rem .5rem; border-radius:.5rem;
}
.tree .course .title-row:hover{ background:rgba(0,0,0,.04) }
:root[data-theme="dark"] .tree .course .title-row:hover{ background:rgba(255,255,255,.04) }

.tree .course .meta{ font-size:.85rem; color:var(--muted); }

.module-row{
  padding:.35rem .5rem .5rem 1.5rem;
  margin-top:.2rem;
}
.module-row .m-title{ font-weight:600; cursor:pointer }
.module-row .m-sub{ font-size:.85rem; color:var(--muted); }
.progress{ width:100%; height:8px; background:var(--tile-bg); border-radius:999px; overflow:hidden; margin-top:.35rem }
.progress-bar{ height:8px; background: var(--green); width:0% }

.sidebar-footer{
  padding: .6rem; display:flex; gap:.5rem; border-top:1px solid var(--border);
}

/* Main */
#main{ flex:1; min-width: 0; display:flex; flex-direction:column; height:100vh }
.topbar{ padding:.8rem 1rem; border-bottom:1px solid var(--border); display:flex; align-items:center; gap:.75rem }
.search{
  width: 100%; background: var(--surface); border:1px solid var(--border);
  padding:.6rem .8rem; border-radius:.6rem; color:var(--text);
}

.view{ display:none; padding: 1rem 1.2rem; overflow:auto }
.view.active{ display:block }

.cards{ display:grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1rem }
.card{
  border:1px solid var(--border); border-radius:.8rem; overflow:hidden; background:var(--surface);
  display:flex; flex-direction:column;
}
.card .thumb{
  background: var(--tile-bg); height: 140px; display:flex; align-items:center; justify-content:center;
  color: var(--muted); font-weight:700; font-size: .95rem;
}
.card img{ width:100%; height:140px; object-fit:cover; display:block }
.card .body{ padding:.8rem }
.card h3{ margin:.2rem 0 .3rem; font-size: 1rem }
.card .muted{ font-size:.9rem; color: var(--muted) }
.pill{ display:inline-flex; align-items:center; gap:.4rem; font-size:.8rem; border:1px solid var(--border); padding:.25rem .5rem; border-radius:999px }

/* Module view */
.crumbs{ display:flex; align-items:center; gap:.5rem; font-size:.9rem; color:var(--muted); margin-bottom:.75rem }
.crumbs a{ color:inherit; text-decoration:none }
.crumbs .sep{ opacity:.6 }

.module-header{ display:flex; align-items:flex-start; justify-content:space-between; gap:1rem; margin-bottom: .8rem }
.module-meta h2{ margin:.2rem 0 }
.module-actions{ display:flex; gap:.5rem }

.grid{
  display:grid; gap:.4rem; grid-template-columns: repeat(10, minmax(36px, 1fr));
}
.tile{
  user-select:none;
  height:42px; display:flex; align-items:center; justify-content:center;
  border-radius:.4rem; border:1px solid var(--border);
  background: var(--tile-bg); color: var(--tile-ink); font-weight:600;
  cursor:pointer; transition: transform .05s ease;
}
.tile:hover{ transform: translateY(-1px) }
.tile.watched{ background: var(--green); color: #052e1b; border-color: var(--green) }
:root[data-theme="dark"] .tile.watched{ color: #062e1d }

.logs{ margin-top:1.2rem }
.logs ul{ list-style:none; padding:0; margin:0; display:grid; gap:.4rem }
.logs li{ font-size:.9rem; color: var(--muted) }

/* Dialogs */
dialog{ border: none; padding: 0; background: transparent }
.dialog{
  width: 380px; max-width: calc(100vw - 2rem);
  background: var(--surface); border:1px solid var(--border); border-radius:.8rem;
  padding:1rem; color: var(--text);
}
.dialog h3{ margin-top:0 }
.dialog label{ display:block; font-size:.9rem; margin:.6rem 0 }
.dialog input{
  width:100%; border:1px solid var(--border); border-radius:.5rem; padding:.55rem .7rem; background: var(--bg); color: var(--text);
}
.dialog menu{ display:flex; justify-content:flex-end; gap:.5rem; padding:0; margin-top:.8rem }

/* Utils */
.flex{ display:flex } .gap-4{ gap: .4rem } .muted{ color: var(--muted) }

@media (max-width: 980px){
  #sidebar{ width: 260px }
  .grid{ grid-template-columns: repeat(8, minmax(36px, 1fr)) }
}
@media (max-width: 680px){
  #sidebar{ display:none }
  .grid{ grid-template-columns: repeat(6, minmax(36px, 1fr)) }
}
